(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{17:function(e,t,n){e.exports=n(41)},23:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(14),l=n.n(o),c=n(16),s=n(15),u=n(1),i=n.n(u),p=n(3),m=(n(23),function(e){var t=e.onClick,n=e.text;return r.a.createElement("button",{onClick:t},n)}),d=function(){return r.a.createElement("div",{style:{color:"green",fontStyle:"italic",fontSize:16}},r.a.createElement("br",null),r.a.createElement("em",null," Bloglist app, Department of Computer Science, University of Helsinki 2019"))},g=function(e){var t=e.handleLogin,n=e.username,a=e.password;return r.a.createElement("div",{clsssName:"form-login"},r.a.createElement("h2",null,"Log in to application"),r.a.createElement("form",{onSubmit:t},r.a.createElement("div",{className:"form-group-control"},"username:",r.a.createElement("input",Object.assign({},n.inputProps,{name:"name"}))),r.a.createElement("div",{className:"form-group-control"},"password:",r.a.createElement("input",Object.assign({},a.inputProps,{name:"password"}))),r.a.createElement("button",{type:"submit"},"login")))},f=function(e){console.log("add form: ",e);var t=e.handleAddBlog,n=e.title,a=e.author,o=e.url;return r.a.createElement("div",{className:"form-group"},r.a.createElement("form",{onSubmit:t},r.a.createElement("div",{className:"form-group-control"},"Title: ",r.a.createElement("input",Object.assign({},n.inputProps,{required:!0}))),r.a.createElement("div",{className:"form-group-control"},"Author: ",r.a.createElement("input",Object.assign({},a.inputProps,{required:!0}))),r.a.createElement("div",{className:"form-group-control"},"url: ",r.a.createElement("input",Object.assign({},o.inputProps,{required:!0}))),r.a.createElement("div",{className:"form-group-control"},r.a.createElement("button",{type:"submit"},"Create"))))},b=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),o=Object(p.a)(n,2),l=o[0],c=o[1],s={display:l?"none":""},u={display:l?"":"none"},i=function(){c(!l)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:i}})),r.a.createElement("div",null,r.a.createElement("div",{style:s},r.a.createElement("button",{onClick:i},e.buttonLabel)),r.a.createElement("div",{style:u,className:"togglableContent"},e.children,r.a.createElement("button",{onClick:i},"cancel")))})),v=function(e){var t=e.message;return null===t?null:r.a.createElement("div",{className:"error"},t)},E=function(e){var t=e.message;return null===t?null:r.a.createElement("div",{className:"success"},t)},h=r.a.forwardRef((function(e,t){var n=e.blog,o=e.handleLike,l=e.handleDelete;console.log("blog visibility: ",n);var c=Object(a.useState)(!1),s=Object(p.a)(c,2),u=s[0],i=s[1],d=function(){i(!u)};Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:d}}));var g={display:u?"":"none"};return console.log("blog detail: ",n),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:g,className:"blog-detail"},r.a.createElement("p",null,r.a.createElement("a",{href:n.url},n.url)),r.a.createElement("p",null,n.likes," likes ",r.a.createElement(m,{onClick:o,text:"like"})),r.a.createElement("p",null,"added by ",r.a.createElement("span",null,n.user.name)),r.a.createElement(m,{onClick:l,text:"remove"})))})),w=function(e){var t=e.blog,n=e.handleLike,a=e.handleDelete,o=r.a.createRef();return r.a.createElement("div",{className:"blog"},r.a.createElement("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},onClick:function(){o.current.toggleVisibility()},className:"blog-user"},r.a.createElement("span",{className:"title"},t.title)," \xa0",r.a.createElement("span",{className:"author"},t.author)),r.a.createElement(h,{blog:t,handleLike:n,handleDelete:a,ref:o}))},x=function(e){var t=e.blogs,n=e.handleLike,a=e.handleDelete;return console.log("blog list component: blogs: ",t),r.a.createElement("div",null,t.sort((function(e,t){return t.likes-e.likes})).map((function(e){return r.a.createElement(w,{key:e.id,blog:e,handleLike:n(e.id),handleDelete:a(e.id)})})))},y=n(4),k=n.n(y),O=null,j=function(){var e;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.awrap(k.a.get("/api/blogs"));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}))},N=function(e){var t,n;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t={headers:{Authorization:O}},a.next=3,i.a.awrap(k.a.post("/api/blogs",e,t));case 3:return n=a.sent,a.abrupt("return",n.data);case 5:case"end":return a.stop()}}))},S=function(e,t){var n,a;return i.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n={headers:{Authorization:O}},r.next=3,i.a.awrap(k.a.put("".concat("/api/blogs","/").concat(e),t,n));case 3:return a=r.sent,r.abrupt("return",a.data);case 5:case"end":return r.stop()}}))},L=function(e){var t,n;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t={headers:{Authorization:O}},a.next=3,i.a.awrap(k.a.delete("".concat("/api/blogs","/").concat(e),t));case 3:return n=a.sent,a.abrupt("return",n.data);case 5:case"end":return a.stop()}}))},C=function(e){O="bearer ".concat(e)},P=function(e){var t;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.a.awrap(k.a.post("/api/login",e));case 2:return t=n.sent,n.abrupt("return",t.data);case 4:case"end":return n.stop()}}))},D=function(e){var t=Object(a.useState)(""),n=Object(p.a)(t,2),r=n[0],o=n[1];return{inputProps:{type:e,value:r,onChange:function(e){o(e.target.value)}},reset:function(e){o(e)}}};var B=function(){var e=Object(a.useState)([]),t=Object(p.a)(e,2),n=t[0],o=t[1],l=Object(a.useState)(""),u=Object(p.a)(l,2),h=u[0],w=u[1],y=Object(a.useState)(null),k=Object(p.a)(y,2),O=k[0],B=k[1],T=Object(a.useState)(null),A=Object(p.a)(T,2),I=A[0],J=A[1],R=D("username"),z=D("password"),V=D("text"),q=D("text"),H=D("text"),U=r.a.createRef();Object(a.useEffect)((function(){j().then((function(e){o(e)}))}),[]),console.log("initial blogs",n),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogListappUser");if(e){var t=JSON.parse(e);w(t),C(t.token)}}),[]);var W=function(e){var t;return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e.preventDefault(),n.prev=1,n.next=4,i.a.awrap(P({username:R.inputProps.value,password:z.inputProps.value}));case 4:t=n.sent,console.log("user services",t),window.localStorage.setItem("loggedBlogListappUser",JSON.stringify(t)),C(t.token),w(t),R.reset(""),z.reset(""),n.next=17;break;case 13:n.prev=13,n.t0=n.catch(1),B(" Wrong username or password"),setTimeout((function(){B(null)}),5e3);case 17:case"end":return n.stop()}}),null,null,[[1,13]])},F=function(e){var t,a;return i.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e.preventDefault(),console.log("create blog"),U.current.toggleVisibility(),r.prev=3,t={title:V.inputProps.value,author:q.inputProps.value,url:H.inputProps.value},console.log("new object to add: ",JSON.stringify(t)),r.next=8,i.a.awrap(N(t));case 8:a=r.sent,console.log("new object to add: ",JSON.stringify(a)),o([].concat(Object(s.a)(n),[a])),J("a new blog added: ".concat(V.inputProps.value," by ").concat(h.name)),V.reset(""),q.reset(""),H.reset(""),setTimeout((function(){J(null)}),5e3),r.next=22;break;case 18:r.prev=18,r.t0=r.catch(3),B("Something went wrong  ".concat(r.t0)),setTimeout((function(){B(null)}),5e3);case 22:case"end":return r.stop()}}),null,null,[[3,18]])},G=function(e){window.localStorage.clear(),w(null),C(null)},K=function(e){return function(t){var a,r,l,s;return i.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return t.preventDefault(),u.prev=1,u.next=4,i.a.awrap(n.find((function(t){return t.id===e})));case 4:return a=u.sent,console.log("found blog",a),r=a.likes+1,l=Object(c.a)({},a,{likes:r,user:h.id}),console.log("updated blog",l),u.next=11,i.a.awrap(S(e,l));case 11:s=u.sent,console.log("updated blog",s),o(n.map((function(t){return t.id!==e?t:s}))),J("Blog ".concat(a.title," written by ").concat(a.author," liked!")),setTimeout((function(){J(null)}),5e3),u.next=22;break;case 18:u.prev=18,u.t0=u.catch(1),B("Something went wrong  ".concat(u.t0)),setTimeout((function(){B(null)}),5e3);case 22:case"end":return u.stop()}}),null,null,[[1,18]])}},M=function(e){return function(t){var a,r,l;return i.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return t.preventDefault(),c.next=3,i.a.awrap(n.find((function(t){return t.id===e})));case 3:return a=c.sent,console.log("found blog:",a),console.log("found blog id: ",a.id),console.log("found blog blogId: ",e),c.next=9,i.a.awrap(n.filter((function(t){return t.id!==e})));case 9:if(r=c.sent,console.log("new blog list: ",r),!window.confirm("Remove blog ".concat(a.title," by ").concat(a.author,"?"))){c.next=27;break}return c.prev=13,c.next=16,i.a.awrap(L(e));case 16:l=c.sent,console.log("updated blog",l),o(r),J("Blog post ".concat(a.title," deleted")),setTimeout((function(){J(null)}),5e3),c.next=27;break;case 23:c.prev=23,c.t0=c.catch(13),B("Something went wrong  ".concat(c.t0)),setTimeout((function(){B(null)}),5e3);case 27:case"end":return c.stop()}}),null,null,[[13,23]])}};return r.a.createElement("div",{className:"wrapper"},r.a.createElement(v,{message:O}),h?function(){if(n.length)return r.a.createElement("div",{className:"wrapper-box"},r.a.createElement("h2",null,"Blogs"),r.a.createElement(E,{message:I}),r.a.createElement("p",null,h.name," logged in",r.a.createElement(m,{onClick:G,text:"Logout"})),r.a.createElement(b,{buttonLabel:"create",ref:U},r.a.createElement(f,{handleAddBlog:F,title:V,author:q,url:H})),r.a.createElement("div",{className:"wrapper-box-container"},r.a.createElement(x,{blogs:n,handleLike:K,handleDelete:M})))}():r.a.createElement("div",{className:"wrapper-box"},r.a.createElement(g,{handleLogin:W,username:R,password:z})),r.a.createElement(d,null))};l.a.render(r.a.createElement(B,null),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.c8d2fdc6.chunk.js.map